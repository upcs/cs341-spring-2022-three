<!DOCTYPE html>
<html>
    <Meta name="viewport" content="'width=device-width, initial-scale=1.0">

    <!-- link to use chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

    <!-- Item 3: Filtering Table-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/table-style.css"></link> <!-- Change based on location -->

    <!-- link to use mapbox-->
    <script src='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
    
    <!-- link for search box -->
    <script src="https://cdn-geoweb.s3.amazonaws.com/esri-leaflet/0.0.1-beta.5/esri-leaflet.js"></script>
    <script src="https://cdn-geoweb.s3.amazonaws.com/esri-leaflet-geocoder/0.0.1-beta.5/esri-leaflet-geocoder.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn-geoweb.s3.amazonaws.com/esri-leaflet-geocoder/0.0.1-beta.5/esri-leaflet-geocoder.css">

    <!-- link for markers -->
    <script src="https://github.com/mapbox/mapbox-gl-js/blob/0071ce73ec481ed38fe50e63fcbfb935c1b76657/src/ui/marker.js#L62-L759"></script>

    <!-- link for leaflet -->
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/leaflet.markercluster.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.css' rel='stylesheet' />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.Default.css' rel='stylesheet' />

    <script src="javascripts/map.js"></script>
    
    <head>
        <meta charset="utf-8">
        <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
        <title>Cary Police Incident Visualization</title>
        <link rel="stylesheet" href="stylesheets/dropdown.css"></link>
        <link rel="stylesheet" href="stylesheets/layout.css"></link>
        <link rel="stylesheet" href="stylesheets/search-filter.css"></link>
        <link rel="stylesheet" href="stylesheets/sidebar.css"></link>
        <link rel="stylesheet" href="stylesheets/tabs.css"></link>
        <link rel="stylesheet" href="stylesheets/auto-filter.css"></link>
    </head>

    <body>
        <div class="grid-container" id="main">
          <div class="item1">
            <!-- Title Page Information or Subtitles-->
            <img style="float: left; width: 150px; padding: 15px;" src="images/logo.png" alt="placeholder" >
            <h1 class="font1">Cary Police Incident Visualization</h1>
          </div>
            <div id="mySidebar" class="sidenav" action="/action_page.php">
                <form autocomplete="off" action="" id="filters">
                  <table>
                    <tr>
                      <!-- script src="javascripts/click-drop.js"></script -->
                      <input id="myInput" type="text" id="crime-type" placeholder="Incident Type">
                      
                      <script>
                        function autocomplete(inp, arr) {
                            /*the autocomplete function takes two arguments,
                            the text field element and an array of possible autocompleted values:*/
                            var currentFocus;
                            /*execute a function when someone writes in the text field:*/
                            inp.addEventListener("input", function(e) {
                                var a, b, i, val = this.value;
                                /*close any already open lists of autocompleted values*/
                                closeAllLists();
                                if (!val) { return false;}
                                currentFocus = -1;
                                /*create a DIV element that will contain the items (values):*/
                                a = document.createElement("DIV");
                                a.setAttribute("id", this.id + "autocomplete-list");
                                a.setAttribute("class", "autocomplete-items");
                                /*append the DIV element as a child of the autocomplete container:*/
                                this.parentNode.appendChild(a);
                                /*for each item in the array...*/
                                for (i = 0; i < arr.length; i++) {
                                  /*check if the item starts with the same letters as the text field value:*/
                                  if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
                                    /*create a DIV element for each matching element:*/
                                    b = document.createElement("DIV");
                                    /*make the matching letters bold:*/
                                    b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
                                    b.innerHTML += arr[i].substr(val.length);
                                    /*insert a input field that will hold the current array item's value:*/
                                    b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                                    /*execute a function when someone clicks on the item value (DIV element):*/
                                    b.addEventListener("click", function(e) {
                                        /*insert the value for the autocomplete text field:*/
                                        inp.value = this.getElementsByTagName("input")[0].value;
                                        /*close the list of autocompleted values,
                                        (or any other open lists of autocompleted values:*/
                                        closeAllLists();
                                    });
                                    a.appendChild(b);
                                  }
                                }
                            });
                            /*execute a function presses a key on the keyboard:*/
                            inp.addEventListener("keydown", function(e) {
                                var x = document.getElementById(this.id + "autocomplete-list");
                                if (x) x = x.getElementsByTagName("div");
                                if (e.keyCode == 40) {
                                  /*If the arrow DOWN key is pressed,
                                  increase the currentFocus variable:*/
                                  currentFocus++;
                                  /*and and make the current item more visible:*/
                                  addActive(x);
                                } else if (e.keyCode == 38) { //up
                                  /*If the arrow UP key is pressed,
                                  decrease the currentFocus variable:*/
                                  currentFocus--;
                                  /*and and make the current item more visible:*/
                                  addActive(x);
                                } else if (e.keyCode == 13) {
                                  /*If the ENTER key is pressed, prevent the form from being submitted,*/
                                  e.preventDefault();
                                  if (currentFocus > -1) {
                                    /*and simulate a click on the "active" item:*/
                                    if (x) x[currentFocus].click();
                                  }
                                }
                            });
                            function addActive(x) {
                              /*a function to classify an item as "active":*/
                              if (!x) return false;
                              /*start by removing the "active" class on all items:*/
                              removeActive(x);
                              if (currentFocus >= x.length) currentFocus = 0;
                              if (currentFocus < 0) currentFocus = (x.length - 1);
                              /*add class "autocomplete-active":*/
                              x[currentFocus].classList.add("autocomplete-active");
                            }
                            function removeActive(x) {
                              /*a function to remove the "active" class from all autocomplete items:*/
                              for (var i = 0; i < x.length; i++) {
                                x[i].classList.remove("autocomplete-active");
                              }
                            }
                            function closeAllLists(elmnt) {
                              /*close all autocomplete lists in the document,
                              except the one passed as an argument:*/
                              var x = document.getElementsByClassName("autocomplete-items");
                              for (var i = 0; i < x.length; i++) {
                                if (elmnt != x[i] && elmnt != inp) {
                                  x[i].parentNode.removeChild(x[i]);
                                }
                              }
                            }
                            /*execute a function when someone clicks in the document:*/
                            document.addEventListener("click", function (e) {
                                closeAllLists(e.target);
                            });
                          }
                          
                          /*An array containing all the country names in the world:*/
                          var countries = ["Aggravated Assault","Alcohol Offenses","All Other Offenses","Arson","Burglary","Calls for Service","Disorderly Conduct","Drugs","Drunkeness","DUI","Embezzlement","Forgery","Fraud","Gambling","Larceny","Missig Person","Motor Vehicle Theft","Murder","Non Criminal Detain","Non Negligent Traff","Pornography","Simple Assault","Stolen Property","Suicide","Traffic Except DWI","Vandalism","Weapons"];
                          
                          /*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
                          autocomplete(document.getElementById("myInput"), countries);
                        </script>
                    </tr>
                    <tr>
                          <label>Filter Start:
                            <input type="date" id="startdate" value="2000-01-01" min="2000-01-01" max="2023-01-01">
                          </label>
                        </tr>
                        <tr>
                          <label>Filter End:
                            <input type="date" id="enddate" value="2023-01-01" min="2000-01-01" max="2023-01-01">
                          </label>
                        </tr>
                        <tr>
                          <input type="submit" value="submit">
                          <script src="javascripts/submit-filter.js"></script>
                        </tr>
                      </table>
                    </form>
            </div> 
            <div class="item2">
              <div class="tab">
                <button class="tablinks" id="one" onclick="openNav()">≡</button>
                <button class="tablinks" id="two" onclick="closeNav()">≡</button>
                <button class="tablinks" onclick="openCity(event, 'Map')" id="defaultOpen">Map</button>
                <button class="tablinks" onclick="openCity(event, 'Table')">Table</button>
                <button class="tablinks" onclick="openCity(event, 'Chart')">Chart</button>
                <script src="javascripts/sidebar.js"></script>
              </div>
            </div>  
            <div class="item4">
              <div id="Map" class="tabcontent">

                <h1>Map</h1>
                <h2>
                    <div class="center">
                        <div id="map"></div>
                    </div>
                    <script src="javascripts/map.js"></script> 
                    
                </h2>
                  
                
              </div>
            </div>
            <div class="item3">
              <div id="Table" class="tabcontent">
                <!-- Filtering Table -->
                <p>Click on the header of a column to sort the table:</p>
              <table>
                <thead><tr>
                  <th><span id="crime" class="w3-button table-column">Crime Type <i class="caret"></span></th>
                  <th><span id="quantity" class="w3-button table-column">Quantity <i class="caret"></span></th>
                </tr></thead>
                <tbody id="mytable"></tbody>
              </table>
              <script src="javascripts/table-filter.js"></script> <!-- Change based on location -->
              </div>
            </div>
            <div class="item5">
              <div id="Chart" class="tabcontent">
                <h1>Charts</h1>
                <div class="chartcontainer">
                  <canvas class="chart1" id="barChart" style="width:100%;max-width:600px"></canvas>
                  <canvas class="chart2" id="doughnutChart" style="width:100%;max-width:600px"></canvas>
                </div>
                <script src="javascripts/charts.js"></script>
                
              </div> 
            </div>
            <div class="item6">
              <div id="AboutUs" class="tabcontent">
                <h1>About Us</h1>
                
              </div> 
            </div>
            <script src="javascripts/tabs.js"></script>
        </div>
    </body>
</html>
